
The following have been reloaded with a version change:
  1) CUDA/12.1.1 => CUDA/12.4.0


The following have been reloaded with a version change:
  1) GCCcore/12.3.0 => GCCcore/13.3.0
  2) OpenSSL/1.1 => OpenSSL/3
  3) Python/3.11.3-GCCcore-12.3.0 => Python/3.12.3-GCCcore-13.3.0
  4) SQLite/3.42.0-GCCcore-12.3.0 => SQLite/3.45.3-GCCcore-13.3.0
  5) Tcl/8.6.13-GCCcore-12.3.0 => Tcl/8.6.14-GCCcore-13.3.0
  6) XZ/5.4.2-GCCcore-12.3.0 => XZ/5.4.5-GCCcore-13.3.0
  7) binutils/2.40-GCCcore-12.3.0 => binutils/2.42-GCCcore-13.3.0
  8) bzip2/1.0.8-GCCcore-12.3.0 => bzip2/1.0.8-GCCcore-13.3.0
  9) libffi/3.4.4-GCCcore-12.3.0 => libffi/3.4.5-GCCcore-13.3.0
 10) libreadline/8.2-GCCcore-12.3.0 => libreadline/8.2-GCCcore-13.3.0
 11) ncurses/6.4-GCCcore-12.3.0 => ncurses/6.5-GCCcore-13.3.0
 12) zlib/1.2.13-GCCcore-12.3.0 => zlib/1.3.1-GCCcore-13.3.0


The following have been reloaded with a version change:
  1) CUDA/12.4.0 => CUDA/12.1.1
  2) GCCcore/13.3.0 => GCCcore/12.3.0
  3) OpenSSL/3 => OpenSSL/1.1
  4) Python/3.12.3-GCCcore-13.3.0 => Python/3.11.3-GCCcore-12.3.0
  5) SQLite/3.45.3-GCCcore-13.3.0 => SQLite/3.42.0-GCCcore-12.3.0
  6) Tcl/8.6.14-GCCcore-13.3.0 => Tcl/8.6.13-GCCcore-12.3.0
  7) XZ/5.4.5-GCCcore-13.3.0 => XZ/5.4.2-GCCcore-12.3.0
  8) binutils/2.42-GCCcore-13.3.0 => binutils/2.40-GCCcore-12.3.0
  9) bzip2/1.0.8-GCCcore-13.3.0 => bzip2/1.0.8-GCCcore-12.3.0
 10) libffi/3.4.5-GCCcore-13.3.0 => libffi/3.4.4-GCCcore-12.3.0
 11) libreadline/8.2-GCCcore-13.3.0 => libreadline/8.2-GCCcore-12.3.0
 12) ncurses/6.5-GCCcore-13.3.0 => ncurses/6.4-GCCcore-12.3.0
 13) zlib/1.3.1-GCCcore-13.3.0 => zlib/1.2.13-GCCcore-12.3.0

/home/s6jahard/.local/lib/python3.11/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/home/s6jahard/.local/lib/python3.11/site-packages/torchvision/image.so: undefined symbol: _ZN3c106detail23torchInternalAssertFailEPKcS2_jS2_RKSs'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
Apollo
Training Progress:   0%|          | 0/3 [00:00<?, ?epoch/s]13406
Traceback (most recent call last):
  File "/home/s6jahard/ba/test/second_order_optim_models/hessian-approx/hessian-approx.py", line 829, in <module>
    train(optim)
  File "/home/s6jahard/ba/test/second_order_optim_models/hessian-approx/hessian-approx.py", line 789, in train
    ha.calcHessianFull(model,images,labels)
  File "/home/s6jahard/ba/test/second_order_optim_models/hessian-approx/hessian-approx.py", line 641, in calcHessianFull
    hess = compute_hessian_loss(params, images, labels)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/s6jahard/ba/test/second_order_optim_models/hessian-approx/hessian-approx.py", line 631, in compute_hessian_loss
    return hessian(compute_loss, argnums=(0))(params, inputs, targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/software/easybuild-INTEL_A40/software/PyTorch/2.1.2-foss-2023a-CUDA-12.1.1/lib/python3.11/site-packages/torch/_functorch/eager_transforms.py", line 1131, in wrapper_fn
    results = vmap(push_jvp, randomness=randomness)(basis)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/software/easybuild-INTEL_A40/software/PyTorch/2.1.2-foss-2023a-CUDA-12.1.1/lib/python3.11/site-packages/torch/_functorch/apis.py", line 188, in wrapped
    return vmap_impl(func, in_dims, out_dims, randomness, chunk_size, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/software/easybuild-INTEL_A40/software/PyTorch/2.1.2-foss-2023a-CUDA-12.1.1/lib/python3.11/site-packages/torch/_functorch/vmap.py", line 266, in vmap_impl
    return _flat_vmap(
           ^^^^^^^^^^^
  File "/software/easybuild-INTEL_A40/software/PyTorch/2.1.2-foss-2023a-CUDA-12.1.1/lib/python3.11/site-packages/torch/_functorch/vmap.py", line 38, in fn
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/software/easybuild-INTEL_A40/software/PyTorch/2.1.2-foss-2023a-CUDA-12.1.1/lib/python3.11/site-packages/torch/_functorch/vmap.py", line 379, in _flat_vmap
    batched_outputs = func(*batched_inputs, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/software/easybuild-INTEL_A40/software/PyTorch/2.1.2-foss-2023a-CUDA-12.1.1/lib/python3.11/site-packages/torch/_functorch/eager_transforms.py", line 1122, in push_jvp
    output = _jvp_with_argnums(func, args, basis, argnums=argnums, has_aux=has_aux)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/software/easybuild-INTEL_A40/software/PyTorch/2.1.2-foss-2023a-CUDA-12.1.1/lib/python3.11/site-packages/torch/_functorch/vmap.py", line 38, in fn
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/software/easybuild-INTEL_A40/software/PyTorch/2.1.2-foss-2023a-CUDA-12.1.1/lib/python3.11/site-packages/torch/_functorch/eager_transforms.py", line 968, in _jvp_with_argnums
    result_duals = func(*duals)
                   ^^^^^^^^^^^^
  File "/software/easybuild-INTEL_A40/software/PyTorch/2.1.2-foss-2023a-CUDA-12.1.1/lib/python3.11/site-packages/torch/_functorch/eager_transforms.py", line 492, in wrapper_fn
    vjp_out = _vjp_with_argnums(func, *args, argnums=argnums, has_aux=has_aux)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/software/easybuild-INTEL_A40/software/PyTorch/2.1.2-foss-2023a-CUDA-12.1.1/lib/python3.11/site-packages/torch/_functorch/vmap.py", line 38, in fn
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/software/easybuild-INTEL_A40/software/PyTorch/2.1.2-foss-2023a-CUDA-12.1.1/lib/python3.11/site-packages/torch/_functorch/eager_transforms.py", line 294, in _vjp_with_argnums
    primals_out = func(*primals)
                  ^^^^^^^^^^^^^^
  File "/home/s6jahard/ba/test/second_order_optim_models/hessian-approx/hessian-approx.py", line 627, in compute_loss
    outputs = vmap(fcall, in_dims=(None,0))(params, inputs) #vectorize over batch
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/software/easybuild-INTEL_A40/software/PyTorch/2.1.2-foss-2023a-CUDA-12.1.1/lib/python3.11/site-packages/torch/_functorch/apis.py", line 188, in wrapped
    return vmap_impl(func, in_dims, out_dims, randomness, chunk_size, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/software/easybuild-INTEL_A40/software/PyTorch/2.1.2-foss-2023a-CUDA-12.1.1/lib/python3.11/site-packages/torch/_functorch/vmap.py", line 266, in vmap_impl
    return _flat_vmap(
           ^^^^^^^^^^^
  File "/software/easybuild-INTEL_A40/software/PyTorch/2.1.2-foss-2023a-CUDA-12.1.1/lib/python3.11/site-packages/torch/_functorch/vmap.py", line 38, in fn
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/software/easybuild-INTEL_A40/software/PyTorch/2.1.2-foss-2023a-CUDA-12.1.1/lib/python3.11/site-packages/torch/_functorch/vmap.py", line 379, in _flat_vmap
    batched_outputs = func(*batched_inputs, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/s6jahard/ba/test/second_order_optim_models/hessian-approx/hessian-approx.py", line 618, in fcall
    outputs = functional_call(model, params, inputs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/software/easybuild-INTEL_A40/software/PyTorch/2.1.2-foss-2023a-CUDA-12.1.1/lib/python3.11/site-packages/torch/_functorch/functional_call.py", line 143, in functional_call
    return nn.utils.stateless._functional_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/software/easybuild-INTEL_A40/software/PyTorch/2.1.2-foss-2023a-CUDA-12.1.1/lib/python3.11/site-packages/torch/nn/utils/stateless.py", line 264, in _functional_call
    return module(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/software/easybuild-INTEL_A40/software/PyTorch/2.1.2-foss-2023a-CUDA-12.1.1/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/software/easybuild-INTEL_A40/software/PyTorch/2.1.2-foss-2023a-CUDA-12.1.1/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/s6jahard/ba/test/second_order_optim_models/hessian-approx/hessian-approx.py", line 728, in forward
    x = torch.relu(self.conv1(x))
                   ^^^^^^^^^^^^^
  File "/software/easybuild-INTEL_A40/software/PyTorch/2.1.2-foss-2023a-CUDA-12.1.1/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/software/easybuild-INTEL_A40/software/PyTorch/2.1.2-foss-2023a-CUDA-12.1.1/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/software/easybuild-INTEL_A40/software/PyTorch/2.1.2-foss-2023a-CUDA-12.1.1/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 460, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/software/easybuild-INTEL_A40/software/PyTorch/2.1.2-foss-2023a-CUDA-12.1.1/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 456, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 30.07 GiB. GPU 0 has a total capacty of 44.40 GiB of which 12.32 GiB is free. Including non-PyTorch memory, this process has 32.07 GiB memory in use. Of the allocated memory 30.76 GiB is allocated by PyTorch, and 5.35 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Training Progress:   0%|          | 0/3 [00:04<?, ?epoch/s]
